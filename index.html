<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Alya ‚ù§Ô∏è</title>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        /* --- RESET & CORE --- */
        html { scroll-snap-type: y mandatory; scroll-behavior: smooth; }
        body { margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; background-color: #000; color: white; overflow-x: hidden; transition: background 1s ease; }

        /* --- SECTIONS --- */
        section {
            height: 100dvh; width: 100vw;
            scroll-snap-align: start; scroll-snap-stop: always;
            display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;
            position: relative; padding: 10px; box-sizing: border-box;
            background: #121212; overflow: hidden; 
        }
        #secret-section { height: 100dvh; display: none; justify-content: center; align-items: center; background: #000; scroll-snap-align: start; }

        /* --- DECORATIONS (NEW) --- */
        .deco { position: absolute; font-size: 2.5rem; opacity: 0.3; filter: grayscale(100%); transition: 0.5s; cursor: default; z-index: 1; pointer-events: none; }
        /* Make them pop and interactable on hover */
        section:hover .deco { opacity: 0.8; filter: grayscale(0%); pointer-events: auto; }
        .deco:hover { transform: scale(1.2) rotate(10deg); opacity: 1; }
        
        /* Secret interactable deco */
        #secret-deco { cursor: pointer; }

        /* --- OVERLAYS --- */
        #login-screen, #pearl-overlay, #fog-modal, #contract-reveal, #custom-alert-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 10000; transition: opacity 0.5s; background: #000; 
        }
        #pearl-overlay { display: none; }
        #fog-modal { background: rgba(0,0,0,0.9); z-index: 10001; display: none; }
        #contract-reveal { display: none; background: rgba(0,0,0,0.95); z-index: 11000; }
        #custom-alert-overlay { background: rgba(0,0,0,0.8); display: none; z-index: 12000; }
        #fireworks-canvas { position: fixed; top:0; left:0; width:100%; height:100%; z-index: 10500; pointer-events: none; display: none; }

        /* --- UI ELEMENTS --- */
        .login-input { padding: 10px; border-radius: 30px; border: 1px solid #333; background: #2a2a2a; color: white; text-align: center; font-family: 'Courier Prime'; width: 200px; outline: none; }
        .btn-spotify { margin-top: 15px; padding: 12px 30px; border-radius: 30px; background: #1DB954; color: black; font-weight: bold; border: none; cursor: pointer; transition: 0.3s; text-transform: uppercase; box-shadow: 0 4px 15px rgba(29, 185, 84, 0.4); }
        .btn-spotify:hover { transform: scale(1.05); background: #1ed760; }
        .btn-pink { background: #ff4757; color: white; box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4); }
        .pearl-img { width: 180px; height: 180px; border-radius: 50%; border: 4px solid #ff4757; box-shadow: 0 0 20px #ff4757; margin-bottom: 20px; object-fit: cover; }

        /* --- COMPONENTS --- */
        h1 { font-size: 1.8rem; margin: 10px 0; font-weight: 900; z-index: 2; }
        .flame { position: absolute; top: -50px; left: 50%; transform: translateX(-50%); font-size: 4rem; opacity: 0; transition: 0.3s; text-shadow: 0 0 20px orange; pointer-events: none; }
        .flame-active { opacity: 1; animation: flicker 0.1s infinite alternate; }
        @keyframes flicker { from { transform: translateX(-52%) scale(1); } to { transform: translateX(-48%) scale(1.1); } }

        /* --- DISTANCE SECTION --- */
        .bg-distance-color { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; transition: background 1s ease; }
        .bg-distance-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 1; pointer-events: none; }
        .night-mode-active .bg-distance-color { background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%) !important; }
        .night-mode-active .bg-distance-overlay { opacity: 0.8; }
        .night-mode-active .distance-content { opacity: 0.1; filter: blur(5px); pointer-events: none; transition: 0.5s; }
        .distance-content { gap: 15px; } 

        .clock-row { display: flex; gap: 15px; z-index: 2; }
        .clock-box { background: rgba(0,0,0,0.5); padding: 8px 15px; border-radius: 12px; backdrop-filter: blur(5px); }
        .time-text { font-size: 1.1rem; font-weight: bold; font-family: 'Courier Prime'; }
        .loc-text { font-size: 0.6rem; color: #e0e0e0; letter-spacing: 1px; margin-top: 5px; }

        /* TICKETS (FIXED & DECORATED) */
        .ticket-container { display: flex; flex-direction: column; gap: 5px; z-index: 2; width: 100%; align-items: center; }
        .ticket { 
            /* Subtle gradient overlay instead of plain white */
            background: linear-gradient(to right, #ffffff, #f0f2f5); 
            color: black; width: 95%; max-width: 380px; 
            border-radius: 12px; overflow: hidden; /* Fixes round corners */
            display: flex; box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
            transform: scale(0.8); margin: -10px 0; position: relative;
        }
        .ticket-left { padding: 10px; flex: 2; border-right: 2px dashed #ccc; text-align: left; position: relative; }
        .ticket-right { padding: 10px; flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #1DB954; color: white; }
        .ticket-val { font-size: 0.9rem; font-weight: bold; margin-bottom: 2px; font-family: 'Courier Prime'; }
        .ticket-flight { display: flex; justify-content: space-between; font-size: 1rem; font-weight: 900; margin: 5px 0; }
        /* Animated Ticket Sticker */
        .ticket-sticker { position: absolute; top: 5px; right: 10px; width: 30px; height: 30px; opacity: 0.8; }

        .quest-container { width: 95%; max-width: 450px; z-index: 2; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 15px; }
        .quest-item { background: rgba(0,0,0,0.5); padding: 8px; margin: 5px 0; border-radius: 8px; border-left: 3px solid #555; text-align: left; display: flex; align-items: center; font-size: 0.8rem; }
        .quest-item:hover { border-left-color: #1DB954; }
        .quest-checkbox { min-width: 18px; height: 18px; border: 2px solid #1DB954; border-radius: 50%; margin-right: 10px; display: flex; justify-content: center; align-items: center; color: black; font-weight: bold; font-size: 0.7rem; }
        .quest-done { opacity: 0.8; }
        .quest-done .quest-checkbox { background: #1DB954; }
        .quest-active { border-left-color: #ff00de; background: rgba(255, 0, 222, 0.1); }

        .moonlight-msg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; max-width: 400px; text-align: center; opacity: 0; pointer-events: none; transition: opacity 0.5s; z-index: 20; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); padding: 30px; border-radius: 20px; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        .night-mode-active .moonlight-msg { opacity: 1; pointer-events: auto; }
        .night-mode-btn { z-index: 5; background: rgba(0,0,0,0.5); border: 1px solid white; color: white; padding: 8px 20px; font-size: 0.8rem; }

        .music-player { position: fixed; bottom: 20px; right: 20px; background: rgba(24, 24, 24, 0.9); padding: 10px 15px; border-radius: 50px; display: flex; align-items: center; gap: 10px; border: 1px solid #333; z-index: 5000; box-shadow: 0 5px 20px rgba(0,0,0,0.5); backdrop-filter: blur(10px); display: none; }
        .album-art { width: 35px; height: 35px; border-radius: 50%; background: #333; overflow: hidden; animation: spin 4s linear infinite; animation-play-state: paused; }
        .play-active .album-art { animation-play-state: running; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .vol-slider { width: 70px; height: 4px; -webkit-appearance: none; background: #555; border-radius: 2px; outline: none; }
        .vol-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; border-radius: 50%; background: #1DB954; cursor: pointer; }

        /* UTILS */
        .gallery-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; max-width: 350px; }
        .gallery-img { width: 100%; height: 120px; object-fit: cover; border-radius: 10px; background: #333; }
        #garden { width: 100%; height: 150px; border-bottom: 3px solid #ff4757; position: relative; margin-top: 20px; overflow: hidden; }
        .flower { position: absolute; bottom: -50px; font-size: 3rem; animation: growUp 0.8s forwards; cursor: pointer; z-index: 5; }
        @keyframes growUp { to { bottom: 10px; } }
        .plus-one { position: absolute; color: #1DB954; font-weight: bold; font-size: 1.5rem; pointer-events: none; animation: floatUp 1s forwards; z-index: 10; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-50px); opacity: 0; } }
        #flower-toast { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: rgba(29, 185, 84, 0.9); color: white; padding: 10px 20px; border-radius: 30px; font-weight: bold; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 6000; }
        
        .dose-box { width: 90%; max-width: 350px; border: 2px dashed #555; border-radius: 15px; padding: 20px; margin-bottom: 20px; background: rgba(0,0,0,0.2); display: flex; flex-direction: column; align-items: center; }

        .auto-plane-container { position: absolute; top: 25%; left: -150px; width: 100%; height: 100%; pointer-events: none; z-index: 0; animation: flyCycle 30s linear infinite; display: flex; align-items: center; }
        .auto-plane { font-size: 3rem; transform: rotate(90deg); z-index: 2; }
        .plane-trail { height: 4px; background: linear-gradient(to left, rgba(255,255,255,0.8), transparent); width: 0; border-radius: 10px; margin-right: -10px; animation: trailGrow 30s linear infinite; }
        @keyframes flyCycle { 0% { left: -150px; } 100% { left: 110%; } }
        @keyframes trailGrow { 0% { width: 0; opacity: 0;} 10% { opacity: 1; } 80% { width: 300px; opacity: 1; } 100% { width: 300px; opacity: 0; } }

        /* SPOTIFY CARD UPDATED */
        .wrapped-card { width: 90%; max-width: 320px; height: 500px; background: linear-gradient(135deg, #8A2387, #E94057, #F27121); border-radius: 20px; padding: 25px; box-sizing: border-box; display: flex; flex-direction: column; justify-content: space-between; box-shadow: 0 20px 50px rgba(0,0,0,0.5); text-align: left; position: relative; overflow: hidden; }
        .counter-subtext { font-size: 0.8rem; opacity: 0.8; margin-top: 5px; font-family: 'Courier Prime'; }

        .voice-capsule { width: 140px; height: 140px; border-radius: 50%; background: #222; border: 3px solid #1DB954; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; transition: 0.3s; margin-top: 20px; position: relative; overflow: hidden; box-shadow: 0 0 15px rgba(29, 185, 84, 0.5); }
        .voice-capsule:hover { transform: scale(1.05); }
        .voice-waves { height: 40px; display: flex; align-items: center; gap: 3px; }
        .bar { width: 4px; height: 10px; background: #555; border-radius: 2px; animation: none; }
        .voice-active .bar { background: #1DB954; animation: wave 0.5s ease-in-out infinite; }
        @keyframes wave { 0%, 100% { height: 10px; } 50% { height: 30px; } }

        #scratch-container { position: relative; width: 300px; height: 300px; border-radius: 15px; overflow: hidden; border: 2px solid #555; }
        .fog-glow { animation: glow 2s infinite alternate; border-color: #1DB954 !important; }
        @keyframes glow { from { box-shadow: 0 0 10px #1DB954; } to { box-shadow: 0 0 30px #1DB954, 0 0 50px #1DB954; } }

        .contract-paper { background: #fdfdfd; color: #121212; padding: 30px 30px 60px 30px; width: 85%; max-width: 400px; border-radius: 5px; font-family: 'Courier Prime', monospace; box-shadow: 0 0 50px rgba(255,255,255,0.2); text-align: left; position: relative; }
        .signature-box { position: absolute; bottom: 20px; right: 30px; text-align: center; }
        .signature-line { border-bottom: 2px solid #1a0b1a; width: 150px; margin-bottom: 5px; }
        .signature-text { font-family: 'Brush Script MT', cursive; font-size: 1.5rem; color: #1a0b1a; transform: rotate(-5deg); }
        .waiting-text { font-size: 0.8rem; color: #777; font-family: 'Montserrat'; }

        .custom-alert-box { background: #222; border: 1px solid #1DB954; padding: 20px; border-radius: 15px; text-align: center; width: 80%; max-width: 300px; color: white; box-shadow: 0 0 30px rgba(29, 185, 84, 0.4); }
        .achievement { position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); background: #222; border: 2px solid white; color: white; padding: 15px; width: 90%; max-width: 350px; display: flex; align-items: center; gap: 15px; border-radius: 10px; transition: bottom 0.5s; z-index: 12000; font-family: 'Press Start 2P', cursive; font-size: 0.6rem; text-align: left; box-shadow: 0 0 20px rgba(255, 255, 255, 0.2); }
        .ach-icon { min-width: 40px; height: 40px; background: #1DB954; border-radius: 5px; }
        .bg-dark { background: radial-gradient(circle at center, #2a2a2a 0%, #121212 100%); }
        .bg-pink { background: radial-gradient(circle at center, #3a1a25 0%, #121212 100%); }
        .bg-cake { background: radial-gradient(circle at center, #1a0b1a 0%, #000 100%); }

    </style>
</head>
<body onload="startTime()">

    <div id="login-screen">
        <h2 style="margin-bottom: 10px;">Hi, Alya</h2>
        <div style="font-size: 3rem; margin-bottom: 20px;">üë§</div>
        <p style="font-size: 0.8rem; margin-bottom: 10px; color: #777;">PASSCODE (DDMMYYYY)</p>
        <input type="password" id="passcode" class="login-input" placeholder="********">
        <button class="btn-spotify" onclick="attemptLogin()">LOGIN</button>
        <p id="login-error" style="color: #ff4757; margin-top: 10px; display: none;">Wrong password!</p>
    </div>

    <div id="pearl-overlay">
        <h1 style="color: #ff4757; background: black; padding: 5px 20px;">‚ö†Ô∏è SECURITY ALERT ‚ö†Ô∏è</h1>
        <img src="https://placekitten.com/300/300" class="pearl-img" alt="Pearl"> 
        <h2 id="pearl-status" style="margin-top: 20px;">CHECKING URL SAFETY...</h2>
        <p id="pearl-desc" style="color: #bbb;">Pearl is making sure no weird sites open for Mom.</p>
    </div>

    <div id="custom-alert-overlay">
        <div class="custom-alert-box">
            <h3 style="color: #1DB954; margin-bottom: 10px;">Akmal says:</h3>
            <p>I knew you would say yes! ‚ù§Ô∏è</p>
            <button class="btn-spotify" onclick="closeCustomAlert()" style="margin-top: 15px;">OKAY</button>
        </div>
    </div>

    <div id="contract-reveal">
        <canvas id="fireworks-canvas"></canvas>
        <div class="contract-paper" data-aos="zoom-in">
            <h2 style="text-align: center; border-bottom: 2px solid #000; padding-bottom: 15px; margin-top: 0;">‚ù§Ô∏è ETERNAL AGREEMENT</h2>
            <p><strong>Parties:</strong> Akmal & Alya</p>
            <p><strong>Status:</strong> SIGNED & SEALED</p>
            <hr style="border: 1px dashed #ccc; margin: 15px 0;">
            <p>1. We fix things together.</p>
            <p>2. We are Player 1 & Player 2 forever.</p>
            <p>3. Distance is temporary. "Us" is permanent.</p>
            
            <div style="margin-top: 30px;">
                <div class="signature-text">Akmal</div>
                <div class="signature-line"></div>
            </div>
            <div class="signature-box">
                 <div class="waiting-text">(Waiting for Alya...)</div>
                 <div class="signature-line"></div>
            </div>

            <button class="btn-spotify" style="width: 100%; margin-top: 40px;" onclick="unlockSecret()">I LOVE YOU ‚ù§Ô∏è</button>
        </div>
    </div>

    <div id="fog-modal">
        <div style="display: flex; flex-direction: column; align-items: center;">
            <h3 style="margin-bottom: 10px;">Rub to reveal... üå´Ô∏è</h3>
            <div id="scratch-container">
                <img src="us.jpg" id="hidden-photo" style="width: 100%; height: 100%; object-fit: cover; position: absolute; top:0; left:0;"> 
                <canvas id="fog-canvas" width="300" height="300" style="position: absolute; top:0; left:0;"></canvas>
            </div>
            <button class="btn-spotify" style="margin-top: 20px;" onclick="closeFog()">CLOSE</button>
        </div>
    </div>

    <div id="flower-toast">Flower Collected! üå∏</div>

    <div class="music-player" id="music-widget">
        <div class="album-art"><img src="https://i.scdn.co/image/ab67616d0000b2738b52c6b9bc3d396a84c2f682" style="width: 100%; height: 100%; object-fit: cover;"></div>
        <div style="display: flex; flex-direction: column; align-items: flex-start; margin-right: 10px;">
            <span style="font-size: 0.7rem; font-weight: bold;">Tower of Memories</span>
            <span style="font-size: 0.5rem; color: #b3b3b3;">IVRY</span>
        </div>
        <button onclick="toggleMusic()" style="background: none; border: none; color: #1DB954; font-size: 1.2rem; cursor: pointer;">‚ñ∂</button>
        <input type="range" class="vol-slider" min="0" max="100" value="20" oninput="changeVolume(this.value)">
        <audio id="bg-music" loop><source src="music.mp3" type="audio/mpeg"></audio>
    </div>
    
    <audio id="secret-sound"><source src="secret-sound.mp3" type="audio/mpeg"></audio>
    <audio id="secret-audio"><source src="secret.mp3" type="audio/mpeg"></audio>

    <div id="main-site" style="display: none;">

        <section class="bg-cake">
            <div class="deco" style="top: 10%; left: 5%;">‚ú®</div>
            <div class="deco" style="bottom: 15%; right: 10%;">üéà</div>
            
            <div data-aos="fade-down" style="font-size: 3rem;">üéâ</div>
            <h1 data-aos="zoom-in" style="margin-bottom: 5px;">Happy Birthday</h1>
            <h1 style="font-size: 3rem; color: #1DB954;" data-aos="zoom-in" data-aos-delay="300">ALYA</h1>
            <div style="position: relative; margin: 20px 0;">
                <div style="font-size: 6rem;">üßÅ</div>
                <div id="flame" class="flame">üî•</div>
            </div>
            <p id="candle-instruction" style="font-size: 0.9rem; opacity: 0.8;">(Tap to light, then blow into mic!)</p>
            <button id="mic-btn" class="btn-spotify" onclick="startMicrophone()">üïØÔ∏è LIGHT CANDLE</button>
            <h2 id="wish-msg" style="color: #1DB954; opacity: 0; transition: 1s; margin-top: 20px;">WISH GRANTED! ü•≥</h2>
        </section>

        <section id="distance-section">
             <div class="deco" style="top: 5%; right: 5%;">üåç</div>
            <div class="deco" style="bottom: 10%; left: 5%;">üíå</div>

            <div class="bg-distance-color"></div>
            <div class="bg-distance-overlay"></div>
            
            <div class="distance-content" style="width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2;">
                <h2 data-aos="fade-down" style="margin-top: 5px;">The Distance</h2>
                <div style="font-size: 2rem; font-weight: 900; margin: 5px 0;" data-aos="zoom-in">5,600 km</div>
                <div class="clock-row" data-aos="fade-up">
                    <div class="clock-box"><div class="time-text" id="time-my">00:00</div><div class="loc-text">AKMAL (MY)</div></div>
                    <div class="clock-box"><div class="time-text" id="time-uae">00:00</div><div class="loc-text">ALYA (UAE)</div></div>
                </div>
                <div class="quest-container" data-aos="fade-up">
                    <h3 style="text-align: left; margin-bottom: 5px; font-size: 0.9rem;">üìú Quest Log</h3>
                    <div class="quest-item quest-done"><div class="quest-checkbox">‚úì</div><div>2019 - 2021: The First Match</div></div>
                    <div class="quest-item quest-done"><div class="quest-checkbox">‚úì</div><div>2025: Second Chance Accepted</div></div>
                    <div class="quest-item quest-active"><div class="quest-checkbox" style="background: none; color: #ff00de;">‚óè</div><div>Mission: Survive the Distance</div></div>
                    <div class="quest-item"><div class="quest-checkbox"></div><div>Side Quest: Build PC Together</div></div>
                </div>
                <div class="ticket-container">
                    <div class="ticket" data-aos="flip-up">
                        <div class="ticket-left">
                            <div style="font-size: 0.6rem; color: #888;">PASSENGER</div><div class="ticket-val">ALYA</div><div class="ticket-flight"><span>UAE</span> ‚úàÔ∏è <span>MY</span></div><div class="ticket-val" style="color: #1DB954;">SOON‚Ñ¢</div>
                            <img src="ticket-sticker.gif" class="ticket-sticker" alt="sticker">
                        </div>
                        <div class="ticket-right"><div style="transform: rotate(-90deg); font-weight: bold;">BOARDING</div></div>
                    </div>
                    <div class="ticket" data-aos="flip-up" data-aos-delay="100">
                        <div class="ticket-left">
                            <div style="font-size: 0.6rem; color: #888;">PASSENGER</div><div class="ticket-val">AKMAL</div><div class="ticket-flight"><span>MY</span> ‚úàÔ∏è <span>UAE</span></div><div class="ticket-val" style="color: #1DB954;">SOON‚Ñ¢</div>
                             <img src="ticket-sticker.gif" class="ticket-sticker" alt="sticker">
                        </div>
                        <div class="ticket-right"><div style="transform: rotate(-90deg); font-weight: bold;">BOARDING</div></div>
                    </div>
                </div>
                <button class="btn-spotify night-mode-btn" onclick="toggleNightMode()">üåò Night Mode</button>
            </div>

            <div class="moonlight-msg">
                <div style="font-size: 1.2rem; margin-bottom: 20px; line-height: 1.6;">"My moon follows your sun,<br>united by the same moonlight."<br><br><span style="font-size: 2rem;">‚òÄÔ∏è ‚ù§Ô∏è üåô</span></div>
                <button class="btn-spotify night-mode-btn" onclick="toggleNightMode()">Turn Lights On</button>
            </div>
            <div class="auto-plane-container">
                <div class="plane-trail"></div>
                <div class="auto-plane">‚úàÔ∏è</div>
            </div>
        </section>

        <section class="bg-dark">
             <div class="deco" style="top: 10%; left: 10%;">üéß</div>
            <div class="deco" style="bottom: 10%; right: 10%;">üéµ</div>

            <div class="wrapped-card" data-aos="zoom-in">
                <div>
                    <div style="font-size: 2rem; font-weight: 900;">Our Journey</div>
                    <div style="margin-top: 5px; opacity: 0.9;">Artists</div>
                    <div style="font-size: 1.1rem; font-weight: bold;">Akmal & Alya</div>
                </div>
                
                <div style="margin: 15px 0;">
                    <div style="opacity: 0.9; font-size: 0.9rem;">Days Together</div>
                    <div id="days-together-counter" style="font-size: 2.2rem; font-weight: 900; color: #1DB954;">Loading...</div>
                    <div id="total-hours-minutes" class="counter-subtext">Loading hours...</div>
                </div>

                <div>
                    <div style="opacity: 0.9; font-size: 0.9rem;">Next Countdown</div>
                    <div id="next-countdown-timer" style="font-size: 1.1rem; font-weight: bold; font-family: 'Courier Prime'; margin-top: 5px;">Loading...</div>
                </div>
                <div style="position: absolute; bottom: -20px; right: -20px; font-size: 8rem; opacity: 0.1;">‚ù§Ô∏è</div>
            </div>
        </section>

        <section class="bg-dark">
            <div class="deco" style="top: 5%; right: 15%;">üì∏</div>
            <div class="deco" id="secret-deco" style="bottom: 15%; left: 10%;" onclick="playSecretSound()">üß∏</div>

            <h1 data-aos="fade-right">Daily Dose</h1>
            <div class="dose-box">
                <div id="love-display" style="min-height: 50px; color: #1DB954; font-family: 'Courier Prime'; display: flex; align-items: center; justify-content: center; text-align: center; margin-bottom: 15px;">Click below...</div>
                <button class="btn-spotify" onclick="generateLove()">GENERATE REASON üé≤</button>
            </div>
            <div class="gallery-grid" data-aos="fade-up">
                <img src="me.jpeg" class="gallery-img"><img src="her.jpg" class="gallery-img"><img src="us.jpg" class="gallery-img"><img src="silly.jpg" class="gallery-img">
            </div>
            <button class="btn-spotify" onclick="openFog()" style="margin-top: 15px;">üå´Ô∏è FOGGY WINDOW</button>
        </section>

        <section class="bg-pink">
             <div class="deco" style="top: 15%; left: 5%;">ü¶ã</div>
            <div class="deco" style="bottom: 20%; right: 5%;">üêù</div>

            <h1 style="color: #ff4757;">Your Garden üå∏</h1>
            <p style="font-size: 0.8rem; margin-top: 5px;">(Tap to plant, Tap flower to collect!)</p>
            <button class="btn-spotify btn-pink" onclick="plantFlower()">PLANT FLOWER üå±</button>
            <div id="garden"></div>
        </section>

        <section style="background: radial-gradient(circle, #2c3e50 0%, #000000 100%);">
             <div class="deco" style="top: 10%; right: 10%;">üì°</div>
            <div class="deco" style="bottom: 10%; left: 10%;">üí´</div>

            <h1 data-aos="fade-down">Voice Capsule</h1>
            <p data-aos="fade-in">I left a message here for you.</p>
            <div class="voice-capsule" onclick="playVoice()">
                <div style="font-size: 3rem;">üéôÔ∏è</div>
                <div class="voice-waves"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
            </div>
            <p id="voice-text" style="margin-top: 20px; font-size: 0.8rem; opacity: 0;">Playing...</p>
            <audio id="voice-msg"><source src="voice.mp3" type="audio/mpeg"></audio>
        </section>

        <section style="background: black;">
             <div class="deco" style="top: 20%; left: 20%;">‚ùî</div>
            <div class="deco" style="bottom: 20%; right: 20%;">üíñ</div>

            <h1 data-aos="zoom-in">One Last Question...</h1>
            <p data-aos="fade-in" style="margin-bottom: 40px;">Do you believe in us?</p>
            <div style="display: flex; gap: 20px;">
                <button class="btn-spotify" style="background: #333; color: #fff;" onclick="showAkmalAlert()">YES</button>
                <button class="btn-spotify" style="background: #1DB954; transform: scale(1.2);" onclick="triggerFinale()">ALWAYS</button>
            </div>
        </section>

        <section id="secret-section">
            <h1 style="color: #1DB954;">Secret Unlocked üîì</h1>
            <p>You found the hidden part!</p>
            <p style="font-size: 0.8rem; opacity: 0.7;">Here is your special Wrapped Video:</p>
            <div style="width: 90%; max-width: 400px; height: 250px; background: black; border-radius: 12px; margin: 20px auto; overflow: hidden; display: flex; justify-content: center; align-items: center; border: 2px solid #333;">
                <iframe width="100%" height="100%" src="https://www.youtube.com/embed/YOUR_VIDEO_ID" frameborder="0" allowfullscreen style="border-radius: 12px;"></iframe>
            </div>
            <p style="margin-top: 30px;">(P.S. There might be more hidden in the fog...)</p>
        </section>

    </div>

    <div id="achievement" class="achievement">
        <div class="ach-icon"></div>
        <div>
            <div style="color: #ffff00; font-size: 0.6rem;">SECRET UNLOCKED</div>
            <div style="font-size: 0.7rem;">"It was never a website.<br>It was a promise."</div>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        // --- CONFIG DATE ---
        // CHANGE THIS TO YOUR START DATE (YYYY-MM-DD)
        const startDate = new Date("2024-01-01"); 
        const nextBirthday = new Date("April 15, 2026 00:00:00").getTime();

        const reasons = [
            "My moon follows your sun.", "You are my 'mov', unique and irreplaceable.",
            "I can‚Äôt imagine my life without you.", "You stole my heart (twice).",
            "Loving you is the best decision I ever made.", "I want to be your home.",
            "I want to make up for all the time we spent apart.", "You are my safe space.",
            "You are the missing piece I was looking for.", "You listen to me when no one else does."
        ];

        let progress = { flowers: 0, fog: false, night: false, reasons: 0 };
        let achievementUnlocked = false;
        let scratchedPixels = 0;

        function checkARG() {
            if(achievementUnlocked) return;
            if(progress.flowers >= 5 && progress.reasons >= 10 && progress.fog && progress.night) {
                achievementUnlocked = true;
                const ach = document.getElementById('achievement');
                ach.style.bottom = "20px";
                setTimeout(() => { ach.style.bottom = "-100px"; }, 5000);
            }
        }

        // MUSIC & VOLUME
        document.addEventListener("DOMContentLoaded", () => {
            const audio = document.getElementById('bg-music');
            audio.volume = 0.2; 
        });

        function toggleMusic() {
            const audio = document.getElementById('bg-music');
            const widget = document.getElementById('music-widget');
            const btn = widget.querySelector('button');
            if (audio.paused) { audio.play(); btn.innerText = "‚è∏"; widget.classList.add('play-active'); } 
            else { audio.pause(); btn.innerText = "‚ñ∂"; widget.classList.remove('play-active'); }
        }
        function changeVolume(val) {
            const audio = document.getElementById('bg-music');
            audio.volume = val / 100; 
        }

        // SPOTIFY LIVE TIMERS (UPDATED)
        setInterval(() => {
            const now = new Date().getTime();
            
            // 1. Days, Hours, Minutes Together
            const timeDiff = now - startDate.getTime();
            const totalMinutes = Math.floor(timeDiff / (1000 * 60));
            const totalHours = Math.floor(timeDiff / (1000 * 60 * 60));
            const daysTogether = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
            
            document.getElementById("days-together-counter").innerText = `${daysTogether}`;
            document.getElementById("total-hours-minutes").innerText = `(${totalHours.toLocaleString()} hours, ${totalMinutes.toLocaleString()} mins)`;


            // 2. Next Countdown
            const distance = nextBirthday - now;
            if (distance < 0) {
                document.getElementById("next-countdown-timer").innerText = "Happy Birthday!";
            } else {
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                document.getElementById("next-countdown-timer").innerText = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            }
        }, 1000);

        // LOGIN
        function attemptLogin() {
            if(document.getElementById('passcode').value === '15042005') {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('pearl-overlay').style.display = 'flex';
                setTimeout(() => {
                    document.getElementById('pearl-overlay').style.display = 'none';
                    document.getElementById('main-site').style.display = 'block';
                    document.getElementById('music-widget').style.display = 'flex';
                    AOS.init({ duration: 800 });
                }, 3000);
            } else { document.getElementById('login-error').style.display = 'block'; }
        }

        // MIC CAKE
        function startMicrophone() {
            const flame = document.getElementById('flame');
            flame.classList.add('flame-active');
            document.getElementById('mic-btn').style.display = 'none';
            document.getElementById('candle-instruction').innerText = "Make a wish and BLOW!";
            navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const analyser = audioContext.createAnalyser();
                const microphone = audioContext.createMediaStreamSource(stream);
                const scriptProcessor = audioContext.createScriptProcessor(2048, 1, 1);
                analyser.smoothingTimeConstant = 0.8; analyser.fftSize = 1024;
                microphone.connect(analyser); analyser.connect(scriptProcessor); scriptProcessor.connect(audioContext.destination);
                scriptProcessor.onaudioprocess = function() {
                    const array = new Uint8Array(analyser.frequencyBinCount);
                    analyser.getByteFrequencyData(array);
                    let values = 0;
                    for (let i = 0; i < array.length; i++) values += array[i];
                    if ((values / array.length) > 40) { 
                        flame.classList.remove('flame-active');
                        document.getElementById('wish-msg').style.opacity = '1';
                        stream.getTracks().forEach(track => track.stop());
                        scriptProcessor.disconnect();
                    }
                };
            }).catch(err => {
                flame.onclick = function() { this.classList.remove('flame-active'); document.getElementById('wish-msg').style.opacity = '1'; }
            });
        }

        // TIME
        function startTime() {
            const updateTime = () => {
                const now = new Date();
                const myTimeStr = now.toLocaleTimeString('en-US', { timeZone: 'Asia/Kuala_Lumpur', hour: '2-digit', minute: '2-digit', hour12: false });
                const uaeTimeStr = now.toLocaleTimeString('en-US', { timeZone: 'Asia/Dubai', hour: '2-digit', minute: '2-digit', hour12: false });
                document.getElementById('time-my').innerText = myTimeStr;
                document.getElementById('time-uae').innerText = uaeTimeStr;
                const myHour = parseInt(myTimeStr.split(':')[0]);
                const bg = document.querySelector('.bg-distance-color');
                const locTexts = document.querySelectorAll('.loc-text');
                if (myHour >= 6 && myHour < 11) { bg.style.background = "linear-gradient(135deg, #fce38a, #f38181)"; locTexts.forEach(el => el.style.color = "#333"); } 
                else if (myHour >= 11 && myHour < 17) { bg.style.background = "linear-gradient(135deg, #2980B9, #6DD5FA, #FFFFFF)"; locTexts.forEach(el => el.style.color = "#fff"); } 
                else if (myHour >= 17 && myHour < 19) { bg.style.background = "linear-gradient(135deg, #cc2b5e, #753a88)"; locTexts.forEach(el => el.style.color = "#fff"); } 
                else { bg.style.background = "linear-gradient(135deg, #0f0c29, #302b63, #24243e)"; locTexts.forEach(el => el.style.color = "#e0e0e0"); }
            };
            setInterval(updateTime, 1000); updateTime();
        }

        // FOG (Soft & Auto-Reveal)
        function openFog() {
            document.getElementById('fog-modal').style.display = 'flex';
            initCanvas();
        }
        function closeFog() { document.getElementById('fog-modal').style.display = 'none'; }
        function initCanvas() {
            const canvas = document.getElementById('fog-canvas'); const ctx = canvas.getContext('2d');
            const container = document.getElementById('scratch-container');
            canvas.style.opacity = 1; container.classList.remove('fog-glow'); scratchedPixels = 0;
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillStyle = "rgba(200, 200, 200, 0.9)"; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.font = "20px Arial"; ctx.fillStyle = "#555"; ctx.fillText("Rub me!", 110, 150);
            ctx.globalCompositeOperation = 'destination-out';
            ctx.shadowBlur = 20; ctx.shadowColor = "rgba(0,0,0,1)"; // Soft brush
            
            let isDrawing = false;
            function scratch(x, y) { 
                ctx.beginPath(); ctx.arc(x, y, 25, 0, Math.PI * 2, false); ctx.fill();
                scratchedPixels++;
                if(scratchedPixels > 150 && !progress.fog) { // Approx threshold
                     canvas.style.transition = "opacity 1s"; canvas.style.opacity = 0;
                     container.classList.add('fog-glow');
                     progress.fog = true; checkARG();
                }
            }
            canvas.addEventListener('mousedown', () => isDrawing = true); canvas.addEventListener('mouseup', () => isDrawing = false);
            canvas.addEventListener('mousemove', (e) => { if (isDrawing) { const rect = canvas.getBoundingClientRect(); scratch(e.clientX - rect.left, e.clientY - rect.top); } });
            canvas.addEventListener('touchstart', (e) => { isDrawing = true; e.preventDefault(); }); canvas.addEventListener('touchend', () => isDrawing = false);
            canvas.addEventListener('touchmove', (e) => { if (isDrawing) { const rect = canvas.getBoundingClientRect(); const touch = e.touches[0]; scratch(touch.clientX - rect.left, touch.clientY - rect.top); } });
        }

        // UTILS
        function toggleNightMode() { document.body.classList.toggle('night-mode-active'); progress.night = true; checkARG(); }
        
        function plantFlower() {
            const garden = document.getElementById('garden');
            const flowers = ['üå∑', 'üå∏', 'üå∫', 'üåπ'];
            const flower = document.createElement('div');
            
            // SECRET SUNFLOWER CHANCE (20%)
            const isSecret = Math.random() < 0.2; 
            flower.innerText = isSecret ? 'üåª' : flowers[Math.floor(Math.random() * flowers.length)];
            
            flower.classList.add('flower');
            flower.style.left = Math.random() * 90 + '%';
            flower.onclick = function(e) {
                // If Secret Flower -> Play Audio
                if(isSecret) {
                    const secretAudio = document.getElementById('secret-audio');
                    secretAudio.volume = 0.5;
                    secretAudio.play();
                    alert("You found a rare sunflower! üåª Listen closely...");
                }

                const plusOne = document.createElement('div'); plusOne.innerText = "+1"; plusOne.classList.add('plus-one');
                plusOne.style.left = e.clientX + 'px'; plusOne.style.top = e.clientY + 'px'; document.body.appendChild(plusOne);
                const toast = document.getElementById('flower-toast'); toast.style.opacity = '1';
                setTimeout(() => { toast.style.opacity = '0'; }, 1000); setTimeout(() => { plusOne.remove(); }, 1000);
                this.remove();
                progress.flowers++; checkARG();
            };
            garden.appendChild(flower);
        }

        // SECRET DECO SOUND
        function playSecretSound() {
             const secretSound = document.getElementById('secret-sound');
             secretSound.volume = 0.5;
             secretSound.play();
             alert("You found the secret teddy bear! üß∏");
        }
        
        // ALERTS
        function showAkmalAlert() { document.getElementById('custom-alert-overlay').style.display = 'flex'; }
        function closeCustomAlert() { document.getElementById('custom-alert-overlay').style.display = 'none'; }

        // TYPING
        let currentTimeout; 
        function generateLove() {
            const display = document.getElementById('love-display');
            const randomMsg = reasons[Math.floor(Math.random() * reasons.length)];
            if(currentTimeout) clearTimeout(currentTimeout);
            display.innerText = ""; 
            let i = 0;
            function typeWriter() {
                if (i < randomMsg.length) {
                    display.innerHTML += randomMsg.charAt(i); i++;
                    currentTimeout = setTimeout(typeWriter, 5); 
                }
            }
            typeWriter();
            progress.reasons++; checkARG();
        }

        // VOICE
        function playVoice() {
            const audio = document.getElementById('voice-msg');
            const capsule = document.querySelector('.voice-capsule');
            const txt = document.getElementById('voice-text');
            if(audio.paused) {
                document.getElementById('bg-music').pause();
                audio.play();
                capsule.classList.add('voice-active');
                txt.style.opacity = '1';
                audio.onended = function() { capsule.classList.remove('voice-active'); txt.style.opacity = '0'; document.getElementById('bg-music').play(); };
            } else { audio.pause(); capsule.classList.remove('voice-active'); }
        }

        // FINALE
        function triggerFinale() {
            document.getElementById('contract-reveal').style.display = 'flex';
            document.getElementById('fireworks-canvas').style.display = 'block';
            var duration = 5 * 1000; var animationEnd = Date.now() + duration; var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 12000 };
            function randomInRange(min, max) { return Math.random() * (max - min) + min; }
            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) { return clearInterval(interval); }
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
            
            // Allow volume to stay at user level
            const audio = document.getElementById('bg-music'); 
            if(audio.paused) audio.play();
        }

        // SECRET UNLOCK
        function unlockSecret() {
            document.getElementById('contract-reveal').style.display = 'none';
            document.getElementById('fireworks-canvas').style.display = 'none';
            document.getElementById('secret-section').style.display = 'flex'; 
            document.getElementById('secret-section').scrollIntoView({ behavior: 'smooth' });
            alert("Secret Section Unlocked! Scroll down to find it.");
        }
    </script>
</body>
</html>
